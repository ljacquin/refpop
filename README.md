[<img src="img/refpop.png"/>]()

# refpop

## Objective, tasks & analyses, and instructions :

### ðŸŽ¯ Objective

This repository houses ```R``` scripts designed to ensure reproducible data analysis and results, aimed at characterizing the refpop population, according to the FAIR principles defined as follows :

* **F**indable

* **A**ccessible

* **I**nteroperable

* **R**eusable

### ðŸ“Š Tasks & analyses 

#### Repository overview

The refpop scripts aim to automate at their best the following tasks and analyses :

* **Phenotype outlier detection**: Intended to automatically produce a clean phenotype dataset, i.e., one that is free of outliers, using robust multivariate and knowledge-based rule methods

* **Spatial heterogeneity correction**: Aims to address spatial heterogeneity for each trait in the cleaned phenotype dataset, and then identify environments with low heritability using a robust univariate outlier detection method and exclude these for further analysis. For each trait, heritability distributions across all environments are computed before and after spatial heterogeneity correction; these distributions are also computed by management type

* **Adjusted ls-means computation**: Focuses on computing the adjusted phenotypic ls-means for each genotype across environments, using the adjusted phenotypes obtained from spatial heterogeneity correction in each environment

* **Data structure inference**: Focuses on inferring the genomic, phenotypic, and pedigree data structures of the refpop population

* **Genomic prediction accuracy evaluation**: Seeks to evaluate, for each trait, the genomic prediction accuracy for the adjusted phenotypic ls-means based on the genomic data

* **G x E x M evaluation**: Directed towards evaluating, for each trait, the interactions between genotypes, their environments and management types

#### Repository details

Three main folders in the ```refpop``` repository are central to the tasks and analyses performed by the refpop ```R``` scripts:

* ```src```: Houses the ```R``` scripts

* ```data```: Contains the data sourced, processed and analyzed by the ```R``` scripts. Note that some processed data, such as the clean phenotype dataset for example, are written and stored in this folder

* ```results```: Stores the results generated by the ```R``` script tasks and analyses

Furthermore, the ```R``` scripts in ```src``` are distributed accross several folders: ```refpop_data_structure_analysis```, ```refpop_data_treatment_and_analysis```, ```refpop_gem_interaction_analysis``` and ```refpop_predictive_modeling_and_analysis```. These folders are organized according to the specific tasks and analyses performed by the user, such as general data treatment and analyses like outlier identification and removal, spatial heterogeneity correction, and adjusted ls-means, as well as more specialized tasks like genomic prediction modeling and analysis, etc.

##### Script interdependencies for analyses

Most scripts rely on the preprocessed data generated by the scripts in ```refpop_data_treatment_and_analysis```. Therefore, it is strongly recommended to execute the data treatment steps first before proceeding with any further analyses. Otherwise, there is no interdependencies between the ```R``` scripts.

##### Script analyses details


### ðŸ’» Instructions

